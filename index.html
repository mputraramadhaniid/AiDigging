<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI DIGGING - Ready to help you</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet" />
    <link rel="icon" href="https://firebasestorage.googleapis.com/v0/b/renvonovel.appspot.com/o/20250316_191334.jpg?alt=media&token=afb5c73d-872f-4e27-ad76-13f4c2b4481a" type="image/png" />
    <style>
      /* Reset & base */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      body {
        font-family: "Roboto", Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #121212; /* Dark background */
        color: #e0e0e0; /* Light text */
        height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .navbar {
        display: none;
        background-color: #1f1f1f; /* Slightly lighter dark */
        color: #fff;
        justify-content: space-between;
        align-items: center;
        padding: 10px 15px;
      }

      .menu-btn {
        background: none;
        border: none;
        color: #fff;
        font-size: 1.8em;
        cursor: pointer;
      }

      .container {
        flex: 1;
        display: flex;
        height: calc(100vh - 50px);
        overflow: hidden;
      }

      .sidebar {
        display: flex;
        flex-direction: column;
        height: 100%;
        padding: 20px;
        background-color: #121212; /* Gelap, sama seperti body */
        border-right: 1px solid #333; /* Border gelap */
      }
      .sidebar h2,
      .sidebar p {
        margin: 0 0 20px;
        font-weight: 600;
        color: #e0e0e0;
      }

      .chat-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .chat {
        padding: 15px 12px;
        border-bottom: 1px solid #333;
        cursor: pointer;
        border-radius: 8px;
        transition: background-color 0.2s ease;
        color: #ddd;
      }

      .chat:hover {
        background-color: #333;
      }

      .sidebar-overlay {
        display: none;
        position: fixed;
        top: 50px;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.75); /* Darker overlay */
        z-index: 1500;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
      }

      .sidebar-overlay.active {
        display: block;
        opacity: 1;
        pointer-events: all;
      }

      .chat-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        background-color: #121212; /* Match body dark */
        overflow: hidden;
        height: 100%;
        color: #e0e0e0;
      }

      .chat-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 15px 20px;
        border-bottom: 1px solid #333;
        background: #1f1f1f;
      }

      .chat-header p {
        font-size: 1.25rem;
        font-weight: 700;
        color: #e0e0e0;
        margin: 0;
        display: flex;
        align-items: center;
      }

      .chat-header img.icon {
        width: 35px;
        height: 35px;
        margin-left: 6px;
        filter: invert(1); /* White icon */
      }

      .chat-header img.trash {
        width: 35px;
        height: 35px;
        cursor: pointer;
        filter: grayscale(100%) invert(1);
        transition: filter 0.2s ease;
      }

      .chat-header img.trash:hover {
        filter: grayscale(50%) invert(1);
      }

      .chat-box {
        flex-grow: 1;
        overflow-y: auto;
        padding: 20px;
        background-color: #121212;
        scroll-behavior: smooth;
      }

      .message-container {
        display: flex;
        align-items: flex-start;
        margin-bottom: 15px;
      }

      .copy-btn {
        background: none;
        border: none;
        color: #aaa;
        cursor: pointer;
        font-size: 0.8rem;
        margin-top: 4px;
        transition: color 0.3s;
        display: flex;
        align-items: flex-start;
      }
      .copy-btn:hover {
        color: #fff;
      }

      .profile-image {
        display: none;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
        margin-right: 12px;
        border: 1px solid #444;
      }

      .message-content {
        max-width: 75%;
        display: flex;
        flex-direction: column;
      }

      .username {
        display: none;
        font-weight: 700;
        font-size: 14px;
        margin-bottom: 4px;
        color: #ccc;
      }

      .message {
        padding: 8px;
        border-radius: 14px;
        font-size: 16px;
        line-height: 1.5;
        color: #e0e0e0;
        white-space: pre-wrap;
        word-wrap: break-word;
      }

      .message-container.user {
        flex-direction: row-reverse;
      }

      .message-container.user .profile-image {
        margin-left: 12px;
        margin-right: 0;
      }

      .message-container.user .message {
        background-color: #2a2a2a;
        color: #fff;
      }

      .code-block {
        background: #1e1e1e;
        border-radius: 8px;
        margin: 6px 0;
        overflow: hidden;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.6);
        border: 1px solid #444;
      }

      .code-header {
        background: #2a2a2a;
        color: #ccc;
        padding: 8px 12px;
        font-size: 0.85em;
        display: flex;
        justify-content: space-between;
        border-bottom: 1px solid #444;
      }

      .code-header .language {
        font-weight: 600;
        font-family: "Roboto Mono", monospace;
      }

      .code-header .copy-btn {
        background: #444;
        color: #ccc;
        border: none;
        border-radius: 4px;
        padding: 2px 8px;
        font-size: 0.75em;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .code-header .copy-btn:hover {
        background: #666;
        color: #fff;
      }

      pre {
        margin: 0;
        padding: 12px;
        overflow-x: auto;
        color: #eee;
      }

      code {
        font-family: "Roboto Mono", monospace;
        font-size: 0.9em;
        line-height: 1.5;
        color: #eee;
        display: block;
        white-space: pre;
      }

      .inline-code {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
        padding: 2px 6px;
        font-family: "Roboto Mono", monospace;
        font-size: 0.9em;
        color: #80cbc4;
        border: 1px solid #444;
      }

      .text-segment {
        margin: 8px 0;
        line-height: 1.7;
        color: #ccc;
      }

      .input-container {
        display: flex;
        align-items: flex-start; /* Changed to flex-start for textarea alignment */
        justify-content: center;
        width: 100%;
        max-width: 500px;
        margin: 0 auto;
        padding: 12px 16px;
        border-top: 1px solid #333;
        background: #1f1f1f;
        border-radius: 25px;
        margin-bottom: 10px;
      }

      .input-container textarea {
        flex: 5;
        padding: 12px 16px;
        font-size: 16px;
        border: 1px solid #1f1f1f;
        border-radius: 20px;
        outline: none;
        background-color: #1f1f1f;
        color: #eee;
        transition: border-color 0.3s ease;
        resize: none;
        min-height: 48px;
        max-height: 120px; /* 5 lines * 24px line height */
        line-height: 24px;
        overflow-y: auto;
        font-family: "Roboto", Arial, sans-serif;
      }

      .input-container textarea::placeholder {
        color: #eee;
      }

      .input-container textarea:focus {
        border-color: #1f1f1f;
        background-color: #1f1f1f;
      }

      .input-container button {
        margin-left: 12px;
        background-color: #474748;
        border: none;
        border-radius: 50%;
        padding: 10px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.3s ease;
        flex-shrink: 0;
      }

      .input-container button:hover {
        background-color: #2d2d2e;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      }

      .input-container button .material-icons {
        font-size: 24px;
        color: #fff;
      }

      .footer {
        text-align: center;
        font-size: 14px;
        color: #888;
        padding: 8px 0;
        background: #000000;
        border-top: 1px solid #333;
        margin-top: 2px;
      }

      .loading-animation .dot {
        animation: blink 1.5s infinite;
        display: inline-block;
        margin: 0 2px;
        font-weight: bold;
        font-size: 20px;
        color: #888;
      }

      .loading-animation .dot:nth-child(2) {
        animation-delay: 0.2s;
      }
      .loading-animation .dot:nth-child(3) {
        animation-delay: 0.4s;
      }

      .typewriter {
        white-space: nowrap;
        overflow: hidden;
        border-right: 2px solid #ccc;
        animation: typing 2s steps(var(--chars), end), blink-caret 0.75s step-end infinite;
        font-family: monospace;
        font-size: 16px;
        color: #ddd;
      }

      @keyframes blink {
        0% {
          opacity: 0.2;
        }
        20% {
          opacity: 1;
        }
        100% {
          opacity: 0.2;
        }
      }

      @keyframes typing {
        from {
          width: 0;
        }
        to {
          width: 100%;
        }
      }

      @keyframes blink-caret {
        from,
        to {
          border-color: transparent;
        }
        50% {
          border-color: #ccc;
        }
      }

      .typewriter {
        overflow: hidden;
        border-right: 0.15em solid #ccc;
        white-space: nowrap;
        animation: typing 3.5s steps(40, end), blink-caret 0.75s step-end infinite;
      }

      .message.finished-typing {
        border-right: none;
        animation: none;
        white-space: normal;
      }

      .segment-fade-in {
        opacity: 0;
        transform: translateY(10px);
        animation: fadeInUp 0.3s ease forwards;
      }

      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Supaya sidebar fleksibel dan footer tetap paling bawah */
      .sidebar {
        display: flex;
        flex-direction: column;
        height: 100%;
        padding: 20px;
        background-color: #000000;
        border-right: 1px solid #393838;
      }

      /* Chat list tetap di atas dan dapat scroll jika banyak */
      .chat-list {
        flex-grow: 0;
        max-height: 300px; /* sesuaikan jika perlu */
        overflow-y: auto;
        margin-bottom: 15px;
      }

      /* Login/Register */
      .auth-buttons {
        display: flex;
        justify-content: space-around;
        margin-bottom: 15px;
      }

      /* Tombol login & register - stylish */
      .auth-buttons button {
        background: linear-gradient(135deg, #444, #222);
        color: #fff;
        border: none;
        padding: 10px 18px;
        margin-right: 10px;
        margin-bottom: 10px;
        border-radius: 9999px; /* full rounded */
        cursor: pointer;
        font-weight: bold;
        font-size: 14px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }

      .auth-buttons button:hover {
        background: linear-gradient(135deg, #666, #333);
        transform: translateY(-2px);
      }

      /* Tombol pusat bantuan - dengan icon dan layout horizontal */
      .help-center-btn {
        display: flex;
        justify-content: flex-start; /* rata kiri */
        align-items: center;
        background-color: #101010;
        color: #fff;
        border: none;
        width: 100%;
        padding: 10px 8px;
        border-radius: 0px;
        font-weight: 600;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
        margin-bottom: 20px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
      }

      .help-center-btn:hover {
        background-color: #5f5f5f;
        transform: scale(1.02);
      }

      .help-center-btn .icon {
        font-size: 18px;
        width: 33px;
        height: 33px;
        margin-right: 12px;
        margin-left: 4px;
      }

      /* Sidebar footer agar selalu di paling bawah */
      .sidebar-footer {
        display: flex;
        flex-direction: column;
        align-items: flex-start; /* Rata kiri */
        padding: 16px;
        gap: 12px;
        margin-top: auto;
        border-top: 1px solid #444;
        width: 100%; /* Pastikan isi melebar */
      }

      .profile {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .profile-image-sidebar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
      }

      .profile-name {
        font-size: 16px;
        margin-left: 4px;
        font-weight: 600;
        color: #ffffff;
      }

      /* ========== RESPONSIVE ========== */
      @media (max-width: 768px) {
        .chat-header {
          display: none; /* sembunyikan header chat di mobile */
        }

        .navbar {
          display: flex;
        }

        .navbar div {
          font-weight: 600;
          font-size: 1.2em;
        }
        .navbar .trash {
          filter: invert(1);
          width: 35px;
          height: 35px;
          cursor: pointer;
          transition: filter 0.2s ease;
        }

        .navbar .trash:hover {
          filter: invert(1) brightness(0.8);
        }

        .copy-btn {
          background: none;
          border: none;
          color: #aaa;
          cursor: pointer;
          font-size: 0.8rem;
          margin-top: 4px;
          margin-left: 4px;
          transition: color 0.3s;
          display: flex;
          align-items: flex-start;
        }
        .copy-btn:hover {
          color: #fff;
        }

        .container {
          flex-direction: column;
          height: calc(100vh - 50px);
        }

        /* Sidebar geser dan overlay */
        .sidebar {
          position: fixed;
          top: 50px;
          left: 0;
          width: 250px;
          height: calc(100vh - 50px);
          transform: translateX(-100%);
          box-shadow: 2px 0 8px rgba(0, 0, 0, 0.8);
          transition: transform 0.3s ease;
          z-index: 2000;
          background-color: #1e1e1e;
          padding: 8px;
        }

        .sidebar.active {
          transform: translateX(0);
        }

        /* Overlay aktif saat sidebar aktif */
        .sidebar-overlay {
          display: block;
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.3s ease;
          z-index: 1500;
        }
        .sidebar-overlay.active {
          opacity: 1;
          pointer-events: all;
        }

        .profile {
          padding: 0px;
          display: flex;
          align-items: center;
          gap: 10px;
        }

        .profile-image-sidebar {
          display: flex;
          align-items: flex-start;
          width: 40px;
          height: 40px;
          border-radius: 50%;
          object-fit: cover;
        }

        .profile-name {
          font-size: 16px;
          margin-left: 4px;
          font-weight: 600;
          color: #ffffff;
        }

        .chat-container {
          height: calc(100vh - 50px);
        }

        .chat-box {
          padding: 15px 10px;
          /* buat scroll penuh tinggi */
          flex-grow: 1;
          overflow-y: auto;
          -webkit-overflow-scrolling: touch;
        }

        .profile-image {
          width: 36px;
          height: 36px;
        }

        .message-content {
          max-width: 80%;
        }

        .message {
          font-size: 14px;
          padding: 8px 12px;
        }

        .input-container {
          padding: 8px 12px;
        }

        .input-container textarea {
          font-size: 14px;
          padding: 10px 14px;
          min-height: 40px;
          max-height: 100px;
        }

        .input-container button {
          padding: 10px;
          margin-left: 8px;
          width: 42px;
          height: 42px;
          border-radius: 50%;
        }
      }
    </style>
  </head>
  <body>
    <!-- Navbar Mobile -->
    <div class="navbar">
      <button class="menu-btn" id="leftMenuBtn" aria-label="Toggle sidebar">&#9776;</button>
      <div>AiDigging</div>
      <img src="images/new.png" alt="trash" class="trash" title="Delete chat" id="clearChatBtn" />
    </div>

    <div class="container">
      <aside class="sidebar" id="sidebar">
        <h2>Choose the conversation</h2>
        <p>Please select a conversation to start chatting.</p>

        <ul class="chat-list">
          <li class="chat">Chat 1</li>
          <li class="chat">Chat 2</li>
          <li class="chat">Chat 3</li>
          <li class="chat">Chat 4</li>
        </ul>

        <!-- Login/Register -->
        <div class="auth-buttons" style="display: none">
          <button class="login-btn" type="button">Login</button>
          <button class="register-btn" type="button">Register</button>
        </div>

        <!-- Pusat Bantuan -->
        <button class="help-center-btn" type="button" onclick="alert('Pusat bantuan akan segera hadir!')">
          <img class="icon" src="images/help.png" alt="Help" />
          <span>Pusat Bantuan</span>
        </button>

        <!-- Profil di paling bawah -->
        <div class="sidebar-footer">
          <div class="profile">
            <img src="https://i.pravatar.cc/40" alt="Profile Image" class="profile-image-sidebar" />
            <span class="profile-name">Profile</span>
          </div>
        </div>
      </aside>

      <!-- Overlay -->
      <div class="sidebar-overlay" id="sidebarOverlay"></div>

      <!-- Chat Container -->
      <section class="chat-container">
        <header class="chat-header">
          <p>AiDigging</p>
          <img src="images/new.png" alt="trash" class="trash" title="Delete chat" id="clearChatBtn" />
        </header>

        <div class="chat-box" id="chatBox">
          <!-- Messages will appear here -->
        </div>

        <form class="input-container" id="chatForm">
          <textarea id="chatInput" placeholder="Type your message here..." rows="1" autocomplete="off" required></textarea>
          <button type="submit" aria-label="Send message">
            <span class="material-icons">send</span>
          </button>
        </form>
      </section>
    </div>

    <footer class="footer">© 2025 AI DIGGING. By M Putra Ramadhani-Id</footer>

    <script>
      const leftMenuBtn = document.getElementById("leftMenuBtn");
      const sidebar = document.getElementById("sidebar");
      const sidebarOverlay = document.getElementById("sidebarOverlay");

      leftMenuBtn.addEventListener("click", () => {
        sidebar.classList.toggle("active");
        sidebarOverlay.classList.toggle("active");
      });

      sidebarOverlay.addEventListener("click", () => {
        sidebar.classList.remove("active");
        sidebarOverlay.classList.remove("active");
      });

      const chatBox = document.getElementById("chatBox");
      const chatForm = document.getElementById("chatForm");
      const chatInput = document.getElementById("chatInput");
      const clearChatBtn = document.getElementById("clearChatBtn");

      let messages = [];
      let isLoading = false;

      // Auto-resize textarea based on content
      chatInput.addEventListener("input", function () {
        this.style.height = "auto";
        const maxHeight = 120; // 5 lines * 24px line height
        this.style.height = Math.min(this.scrollHeight, maxHeight) + "px";
      });

      // Handle Enter key for new lines and Shift+Enter for submission
      chatInput.addEventListener("keydown", function (e) {
        if (e.key === "Enter" && !e.shiftKey) {
          e.preventDefault();
          chatForm.dispatchEvent(new Event("submit"));
        }
      });

      chatForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const text = chatInput.value.trim();
        if (!text || isLoading) return;

        // Tambah pesan user
        await appendMessage("user", text, "You", "https://cdn-icons-png.flaticon.com/512/1077/1077114.png");
        chatInput.value = "";
        chatInput.style.height = "auto"; // Reset textarea height
        chatInput.disabled = true;
        isLoading = true;

        messages.push({ role: "user", content: text });
        saveMessagesToStorage();

        appendLoadingMessage();

        try {
          const response = await fetch("https://api.paxsenix.biz.id/v1/chat/completions", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Authorization: "Bearer YOUR_API_KEY_HERE",
            },
            body: JSON.stringify({
              messages: messages,
              model: "gpt-4",
              temperature: 0.7,
            }),
          });
          const data = await response.json();

          const reply = data.choices?.[0]?.message?.content?.trim() || "No response";
          removeLoadingMessage();

          await appendMessage("bot", reply, "AI Digging", "https://firebasestorage.googleapis.com/v0/b/renvonovel.appspot.com/o/20250526_232210.png?alt=media&token=dc5a0b3a-f869-432a-82a2-c27b32eca77f");
          messages.push({ role: "assistant", content: reply });
          saveMessagesToStorage();
        } catch (err) {
          console.error(err);
          removeLoadingMessage();
          await appendMessage(
            "bot",
            "Terjadi kesalahan saat menghubungi server.",
            "AI Digging",
            "https://firebasestorage.googleapis.com/v0/b/renvonovel.appspot.com/o/20250526_232210.png?alt=media&token=dc5a0b3a-f869-432a-82a2-c27b32eca77f"
          );
        } finally {
          isLoading = false;
          chatInput.disabled = false;
          chatInput.focus();
        }
      });

      function saveMessagesToStorage() {
        localStorage.setItem("chatHistory", JSON.stringify(messages));
      }

      function loadMessagesFromStorage() {
        const stored = localStorage.getItem("chatHistory");
        if (stored) {
          messages = JSON.parse(stored);
          messages.forEach((msg) => {
            const role = msg.role === "user" ? "user" : "bot";
            const username = role === "user" ? "You" : "AI Digging";
            const profile =
              role === "user" ? "https://cdn-icons-png.flaticon.com/512/1077/1077114.png" : "https://firebasestorage.googleapis.com/v0/b/renvonovel.appspot.com/o/20250526_232210.png?alt=media&token=dc5a0b3a-f869-432a-82a2-c27b32eca77f";

            // Load langsung tanpa animasi ketik (instant = true)
            appendMessage(role, msg.content, username, profile, true);
          });
          chatBox.scrollTop = chatBox.scrollHeight;
        }
      }

      function clearChat() {
        if (confirm("Clear all chat history?")) {
          localStorage.removeItem("chatHistory");
          messages = [];
          chatBox.innerHTML = "";
        }
      }

      clearChatBtn.addEventListener("click", clearChat);

      async function appendMessage(sender, text, username, profileUrl, instant = false) {
        const messageContainer = document.createElement("div");
        messageContainer.className = `message-container ${sender} message-fade-in`;

        const profileImg = document.createElement("img");
        profileImg.src = profileUrl;
        profileImg.className = "profile-image";

        const contentContainer = document.createElement("div");
        contentContainer.className = "message-content";

        const nameEl = document.createElement("div");
        nameEl.className = "username";
        nameEl.textContent = username;

        const textEl = document.createElement("div");
        textEl.className = "message";

        contentContainer.appendChild(nameEl);
        contentContainer.appendChild(textEl);

        // Hanya buat tombol copy kalau pengirim BOT
        if (sender === "bot" || sender === "assistant") {
          const copyBtn = document.createElement("button");
          copyBtn.className = sender === "user" ? "copy-btn none" : "copy-btn left"; // user: sembunyi, bot: tampil kiri bawah
          copyBtn.title = "Copy message";

          // SVG icon copy kecil (clipboard)
          copyBtn.innerHTML = `<img src="images/copy.png" alt="Copy" width="16" height="16" />`;
          copyBtn.onclick = function () {
            copyTextFromButton(this);
          };

          contentContainer.appendChild(copyBtn);
        }

        messageContainer.appendChild(profileImg);
        messageContainer.appendChild(contentContainer);
        chatBox.appendChild(messageContainer);
        chatBox.scrollTop = chatBox.scrollHeight;

        if ((sender === "bot" || sender === "assistant") && !instant) {
          await typeText(textEl, text);
        } else {
          textEl.textContent = text;
        }
      }

      async function typeText(element, text, delay = 30) {
        element.textContent = "";
        for (let i = 0; i < text.length; i++) {
          element.textContent += text.charAt(i);
          chatBox.scrollTop = chatBox.scrollHeight;
          await new Promise((resolve) => setTimeout(resolve, delay));
        }
      }

      function appendLoadingMessage() {
        const messageContainer = document.createElement("div");
        messageContainer.id = "loading-message";
        messageContainer.className = "message-container bot";

        const profileImg = document.createElement("img");
        profileImg.src = "https://firebasestorage.googleapis.com/v0/b/renvonovel.appspot.com/o/20250526_232210.png?alt=media&token=dc5a0b3a-f869-432a-82a2-c27b32eca77f";
        profileImg.className = "profile-image";

        const contentContainer = document.createElement("div");
        contentContainer.className = "message-content";

        const nameEl = document.createElement("div");
        nameEl.className = "username";
        nameEl.textContent = "AI Digging";

        const loadingDots = document.createElement("div");
        loadingDots.className = "message loading-animation";
        loadingDots.innerHTML = `<span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>`;

        contentContainer.appendChild(nameEl);
        contentContainer.appendChild(loadingDots);
        messageContainer.appendChild(profileImg);
        messageContainer.appendChild(contentContainer);
        chatBox.appendChild(messageContainer);
        chatBox.scrollTop = chatBox.scrollHeight;
      }

      function removeLoadingMessage() {
        const el = document.getElementById("loading-message");
        if (el) el.remove();
      }

      function copyTextFromButton(button) {
        const messageText = button.previousElementSibling.textContent;
        navigator.clipboard.writeText(messageText).then(() => {
          button.innerHTML = `<img src="images/tick.png" alt="Copy" width="16" height="16" />`;
          setTimeout(() => {
            button.innerHTML = `<img src="images/copy.png" alt="Copy" width="16" height="16" />`;
          }, 1500);
        });
      }

      // Load chat history saat halaman siap
      document.addEventListener("DOMContentLoaded", loadMessagesFromStorage);
    </script>
  </body>
</html>
